package examples.restApiTests;

import com.github.javafaker.Faker;
import io.restassured.RestAssured;
import io.restassured.response.Response;
import org.testng.annotations.Test;


import static java.lang.String.format;

public class RestAssuredTest {

    private String name = Faker.instance().name().username();
    private String email = Faker.instance().internet().emailAddress();
    private String token = "TOKEN"; // your token generated by service GOREST (https://gorest.co.in)

    private String payload = format(
            "{\"name\":\"%s\"," +
                    "\"email\":\"%s\"," +
                    "\"gender\":\"male\"," +
                    "\"status\":\"active\"}", name, email);

    @Test
    public void testPost() {
        Response response = RestAssured.given()
                .baseUri("https://gorest.co.in")
                .header("content-type", "application/json")
                .header("Authorization", format("Bearer %s", token))
                .body(payload)
                .log().ifValidationFails()
                .post("/public/v1/users");

        int id = response.then()
                .assertThat()
                .statusCode(201)
                .extract().body().jsonPath().get("data[\"id\"]");
    }

}
